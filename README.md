# Keyboard Protector

Windowsμ© ν‚¤λ³΄λ“ μ…λ ¥ λ¨λ‹ν„°λ§ λ° μ•”νΈν™” λ³΄μ• λ„κµ¬μ…λ‹λ‹¤. μ €μμ¤€ ν‚¤λ³΄λ“ ν›„ν¬λ¥Ό μ‚¬μ©ν•μ—¬ μ‹μ¤ν… μ „μ²΄μ ν‚¤ μ…λ ¥μ„ κ°μ§€ν•κ³  μ•”νΈν™”ν•μ—¬ μ¶λ ¥ν•©λ‹λ‹¤.

## π€ μ£Όμ” κΈ°λ¥

- **ν‚¤λ³΄λ“ μ…λ ¥ μ•”νΈν™”**: ν‚¤λ³΄λ“ μ…λ ¥μ„ μ‹¤μ‹κ°„μΌλ΅ μ•”νΈν™”ν•μ—¬ μ¶λ ¥
- **ν‚¤ μ…λ ¥ μ°¨λ‹¨ λ° μ„ νƒμ  λ³µνΈν™”**: λ¨λ“  ν‚¤ μ…λ ¥μ„ μ°¨λ‹¨ν•κ³ , ν—μ©λ ν”„λ΅μ„Έμ¤μ—λ§ λ³µνΈν™”λ ν‚¤λ¥Ό μ „λ‹¬
- **ν”„λ΅μ„Έμ¤ κΈ°λ° ν•„ν„°λ§**: INI νμΌμ„ ν†µν•΄ ν—μ©ν•  ν”„λ΅μ„Έμ¤ λ©λ΅ κ΄€λ¦¬
- **μ „μ—­ ν‚¤λ³΄λ“ λ¨λ‹ν„°λ§**: Windows μ €μμ¤€ ν‚¤λ³΄λ“ ν›„ν¬λ΅ λ¨λ“  ν‚¤λ³΄λ“ μ…λ ¥ κ°μ§€
- **μ•μ „ν• μΆ…λ£**: ESC ν‚¤λ¥Ό ν†µν• μ•μ „ν• ν”„λ΅κ·Έλ¨ μΆ…λ£
- **μ‹¤μ‹κ°„ λ¨λ‹ν„°λ§**: ν‚¤ μ…λ ¥ κ°μ§€ λ° μ•”νΈν™”λ λ΅κ·Έ μ¶λ ¥
- **κ΄€λ¦¬μ κ¶ν• ν™•μΈ**: μ‹¤ν–‰ μ‹ κ΄€λ¦¬μ κ¶ν• μƒνƒ ν‘μ‹
- **κ°•ν™”λ μ—λ¬ μ²λ¦¬**: μƒμ„Έν• μ—λ¬ λ©”μ‹μ§€ λ° μ•μ „ν• μΆ…λ£

## π“‹ μ‹μ¤ν… μ”κµ¬μ‚¬ν•­

- **μ΄μμ²΄μ **: Windows XP μ΄μƒ (λ¨λ“  λ²„μ „)
- **κ¶ν•**: κ΄€λ¦¬μ κ¶ν• κ¶μ¥
- **μ•„ν‚¤ν…μ²**: 32λΉ„νΈ λΉλ“ (WOW64λ΅ 64λΉ„νΈ Windowsμ—μ„λ„ μλ™ μ‹¤ν–‰)

## π”§ ν”„λ΅μ νΈ κµ¬μ΅°

```
cursor-keyprotect/
β”β”€β”€ src/
β”‚   β”β”€β”€ main.c              # λ©”μΈ μ§„μ…μ 
β”‚   β”β”€β”€ keyboard_protector.c # ν›„ν¬ κµ¬ν„
β”‚   β””β”€β”€ crypto_keycode.c    # ν‚¤ μ½”λ“ μ•”νΈν™” κΈ°λ¥
β”β”€β”€ include/
β”‚   β””β”€β”€ keyboard_protector.h # ν—¤λ” νμΌ
β”β”€β”€ bin/                    # μ‹¤ν–‰ νμΌ (λΉλ“ ν›„ μƒμ„±)
β”β”€β”€ obj/                    # μ¤λΈμ νΈ νμΌ (λΉλ“ ν›„ μƒμ„±)
β”β”€β”€ config.ini              # ν—μ© ν”„λ΅μ„Έμ¤ μ„¤μ • νμΌ
β”β”€β”€ Makefile               # λΉλ“ μ„¤μ •
β””β”€β”€ README.md              # μ΄ νμΌ
```

## β΅ λΉ λ¥Έ μ‹μ‘

### 1. λΉλ“

```cmd
make
```

μ΄ λ…λ Ήμ€ 32λΉ„νΈ λΉλ“λ¥Ό μƒμ„±ν•©λ‹λ‹¤. 32λΉ„νΈ λΉλ“λ” WOW64λ¥Ό ν†µν•΄ λ¨λ“  Windows λ²„μ „μ—μ„ μ‹¤ν–‰λ©λ‹λ‹¤.

### 2. μ„¤μ • νμΌ μ¤€λΉ„

ν”„λ΅κ·Έλ¨ μ‹¤ν–‰ μ „μ— `config.ini` νμΌμ„ μƒμ„±ν•μ—¬ ν—μ©ν•  ν”„λ΅μ„Έμ¤ λ©λ΅μ„ μ„¤μ •ν•©λ‹λ‹¤.

```ini
[AllowedProcesses]
Process1=notepad++.exe
Process2=notepad.exe
Process3=code.exe
```

**μ°Έκ³ :** `config.ini` νμΌμ΄ μ—†μΌλ©΄ κΈ°λ³Έμ μΌλ΅ `notepad++.exe`λ§ ν—μ©λ©λ‹λ‹¤.

### 3. μ‹¤ν–‰

```cmd
bin\keyboard_protector.exe
```

### 4. μΆ…λ£

ESC ν‚¤λ¥Ό λλ¬ ν”„λ΅κ·Έλ¨μ„ μΆ…λ£ν•©λ‹λ‹¤.

## π› οΈ λΉλ“ λ°©λ²•

### κΈ°λ³Έ λΉλ“ (κ¶μ¥)

```cmd
make
```

μ΄ λ…λ Ήμ€ 32λΉ„νΈ λ¨λ“λ¥Ό κΈ°λ³ΈμΌλ΅ μ‚¬μ©ν•μ—¬ Windows XPλ¶€ν„° μµμ‹  λ²„μ „κΉμ§€ λ¨λ“  Windowsμ—μ„ μ‘λ™ν•λ” μ‹¤ν–‰ νμΌμ„ μƒμ„±ν•©λ‹λ‹¤.

### μ •λ¦¬ ν›„ λ‹¤μ‹ λΉλ“

```cmd
make clean
make rebuild
```

### Make λ…λ Ήμ–΄

```cmd
make          # 32λΉ„νΈ λΉλ“ (λ¨λ“  Windows μ§€μ›)
make clean    # λΉλ“ νμΌ μ •λ¦¬
make rebuild  # μ •λ¦¬ ν›„ λ‹¤μ‹ λΉλ“
make debug    # λ””λ²„κ·Έ λ¨λ“λ΅ λΉλ“
make release  # λ¦΄λ¦¬μ¤ λ¨λ“λ΅ λΉλ“
make run      # λΉλ“ ν›„ μ‹¤ν–‰
make help     # λ„μ›€λ§ ν‘μ‹
```

## π“¦ λΉλ“ μ”κµ¬μ‚¬ν•­

- **μ»΄νμΌλ¬**: MinGW-w64 λλ” GCC
- **Make**: Make λ„κµ¬
- **λΌμ΄λΈλ¬λ¦¬**: 
  - `user32` (Windows GUI)
  - `advapi32` (κ΄€λ¦¬μ κ¶ν• ν™•μΈ)
  - `psapi` (ν”„λ΅μ„Έμ¤ μ •λ³΄ μ΅°ν)
  - `shlwapi` (κ²½λ΅ μ²λ¦¬)

### MinGW-w64 μ„¤μΉ

**Chocolatey μ‚¬μ©:**
```cmd
choco install mingw make -y
```

**μλ™ μ„¤μΉ:**
- https://www.mingw-w64.org/downloads/
- λλ” https://winlibs.com/

## β οΈ μ£Όμμ‚¬ν•­

### λ³΄μ•

- μ΄ ν”„λ΅κ·Έλ¨μ€ **κ΄€λ¦¬μ κ¶ν•**μ΄ ν•„μ”ν•  μ μμµλ‹λ‹¤.
- **λ¨λ“  ν‚¤ μ…λ ¥μ΄ μ°¨λ‹¨**λλ©°, `config.ini`μ— λ“±λ΅λ ν”„λ΅μ„Έμ¤μ—λ§ λ³µνΈν™”λ ν‚¤κ°€ μ „λ‹¬λ©λ‹λ‹¤.
- **ESC ν‚¤λ§**μ΄ ν”„λ΅κ·Έλ¨ μΆ…λ£λ¥Ό μ„ν•΄ ν—μ©λ©λ‹λ‹¤.
- λ³΄μ• λ„κµ¬ λ©μ μΌλ΅λ§ μ‚¬μ©ν•μ„Έμ”.
- ν—μ©λμ§€ μ•μ€ ν”„λ΅μ„Έμ¤μ—μ„λ” ν‚¤ μ…λ ¥μ΄ μ™„μ „ν μ°¨λ‹¨λ©λ‹λ‹¤.

### μ‚¬μ© μ „ ν™•μΈ

```cmd
# ν…μ¤νΈ μ „ κ°€μƒλ¨Έμ‹  μ‚¬μ© κ¶μ¥
# λλ” μ‘μ—… κ΄€λ¦¬μλ΅ κ°•μ  μΆ…λ£ν•λ” λ°©λ²• μ•κ³  μκΈ°

# κ°•μ  μΆ…λ£ λ°©λ²•
taskkill /F /IM keyboard_protector.exe
```

## π› μ•λ ¤μ§„ λ¬Έμ  λ° ν•΄κ²°μ±…

### 1. "κ΄€λ¦¬μ κ¶ν• ν•„μ”" μ¤λ¥

**μ¦μƒ:** ν›„ν¬ μ„¤μΉ μ‹¤ν¨

**ν•΄κ²°:**
- κ΄€λ¦¬μ κ¶ν•μΌλ΅ μ‹¤ν–‰
- λλ” κ°€μƒλ¨Έμ‹ μ—μ„ ν…μ¤νΈ

### 2. λΉλ“ νΈν™μ„±

**ν„μ¬ κµ¬μ„±:** κΈ°λ³Έμ μΌλ΅ 32λΉ„νΈ λΉλ“λ¥Ό μƒμ„±ν•©λ‹λ‹¤.

**μ¥μ :**
- Windows XPλ¶€ν„° μµμ‹  WindowsκΉμ§€ λ¨λ‘ μ§€μ›
- WOW64λ¥Ό ν†µν•΄ 64λΉ„νΈ Windowsμ—μ„λ„ μλ™ μ‹¤ν–‰
- μµλ€ νΈν™μ„± λ³΄μ¥

**λΉλ“:**
```cmd
make
```

## π” λ™μ‘ μ›λ¦¬

1. **INI νμΌ λ΅λ“**: ν”„λ΅κ·Έλ¨ μ‹μ‘ μ‹ `config.ini`μ—μ„ ν—μ© ν”„λ΅μ„Έμ¤ λ©λ΅ λ΅λ“
2. **μ €μμ¤€ ν‚¤λ³΄λ“ ν›„ν¬ μ„¤μΉ** (`WH_KEYBOARD_LL`)
3. **λ¨λ“  ν‚¤ μ…λ ¥ κ°μ§€ λ° μ°¨λ‹¨**: λ¨λ“  ν‚¤ μ…λ ¥μ„ ν›„ν¬μ—μ„ μ°¨λ‹¨
4. **ν‚¤ μ½”λ“ μ•”νΈν™”**: κ° ν‚¤ μ…λ ¥μ„ μ†”νΈμ™€ κ³ μ • ν‚¤λ¥Ό μ‚¬μ©ν•μ—¬ μ•”νΈν™”
5. **ν”„λ΅μ„Έμ¤ ν™•μΈ**: ν„μ¬ ν¬μ»¤μ¤λ μ°½μ ν”„λ΅μ„Έμ¤ ν™•μΈ
6. **μ„ νƒμ  λ³µνΈν™” λ° μ „λ‹¬**:
   - ν—μ©λ ν”„λ΅μ„Έμ¤: μ•”νΈν™”λ ν‚¤λ¥Ό λ³µνΈν™”ν•μ—¬ `SendInput`μΌλ΅ μ „λ‹¬
   - ν—μ©λμ§€ μ•μ€ ν”„λ΅μ„Έμ¤: ν‚¤ μ…λ ¥ μ°¨λ‹¨ (μ „λ‹¬ν•μ§€ μ•μ)
7. **μ•”νΈν™”λ μ •λ³΄ μ¶λ ¥**: μ›λ³Έ ν‚¤ μ½”λ“, μ†”νΈ, μ•”νΈν™”λ ν‚¤ μ½”λ“λ¥Ό μ¶λ ¥
8. **ESC ν‚¤ μ²λ¦¬**: ESC ν‚¤ μ…λ ¥ μ‹ μΆ…λ£ μ‹ νΈ μ „μ†΅
9. **λ©”μ‹μ§€ λ£¨ν”„ μ‹¤ν–‰** (`GetMessage`)
10. **μΆ…λ£ μ‹ ν›„ν¬ ν•΄μ **

## π― μ£Όμ” κ°μ„ μ‚¬ν•­

### ESC ν‚¤ μΆ…λ£ κΈ°λ¥

ESC ν‚¤ μ…λ ¥ μ‹ `PostQuitMessage(0)`μ„ νΈμ¶ν•μ—¬ λ©”μ‹μ§€ λ£¨ν”„λ¥Ό μ •μƒ μΆ…λ£ν•©λ‹λ‹¤.

### μ—λ¬ μ²λ¦¬ κ°•ν™”

- `GetMessage()` λ°ν™κ°’ κ²€μ‚¬ (-1 μ—λ¬ μ²λ¦¬)
- μ‹μ¤ν… μ—λ¬ μ½”λ“ μ¶λ ¥
- μ μ ν• Exit code λ°ν™

### κ΄€λ¦¬μ κ¶ν• ν™•μΈ

Windows Vista μ΄μƒμ—μ„ μλ™μΌλ΅ κ΄€λ¦¬μ κ¶ν•μ„ ν™•μΈν•κ³  ν‘μ‹ν•©λ‹λ‹¤.

### Windows XP νΈν™μ„±

`_WIN32_WINNT=0x0501` μ„¤μ •μ„ ν†µν•΄ Windows XPμ™€μ νΈν™μ„±μ„ λ³΄μ¥ν•©λ‹λ‹¤. 32λΉ„νΈ λΉλ“λ΅ μƒμ„±λμ–΄ λ¨λ“  Windows λ²„μ „μ—μ„ μ‹¤ν–‰ κ°€λ¥ν•©λ‹λ‹¤.

### ν‚¤ μ½”λ“ μ•”νΈν™” κΈ°λ¥

- **XOR κΈ°λ° μ•”νΈν™”**: ν‚¤ μ½”λ“μ™€ μ†”νΈλ¥Ό μ‚¬μ©ν• XOR μ•”νΈν™”
- **μ†”νΈ κΈ°λ° λ³΄μ•**: κ° ν‚¤ μ…λ ¥λ§λ‹¤ λ‹¤λ¥Έ μ†”νΈ(μ‹κ°„ κΈ°λ°) μ‚¬μ©
- **μ•”νΈν™”/λ³µνΈν™” ν•¨μ**: `encrypt_keycode_with_salt()`, `decrypt_keycode_with_salt()` μ κ³µ

### ν”„λ΅μ„Έμ¤ κΈ°λ° ν‚¤ μ…λ ¥ ν•„ν„°λ§

- **ν”„λ΅μ„Έμ¤ κ°μ§€**: ν„μ¬ ν¬μ»¤μ¤λ μ°½μ ν”„λ΅μ„Έμ¤ μ‹¤ν–‰ νμΌ μ΄λ¦„ ν™•μΈ
- **INI νμΌ κΈ°λ° μ„¤μ •**: `config.ini` νμΌμ„ ν†µν•΄ ν—μ© ν”„λ΅μ„Έμ¤ λ©λ΅ κ΄€λ¦¬
- **μ„ νƒμ  ν‚¤ μ „λ‹¬**: ν—μ©λ ν”„λ΅μ„Έμ¤μ—λ§ λ³µνΈν™”λ ν‚¤ μ…λ ¥ μ „λ‹¬
- **ν‚¤λ΅κ±° μ°¨λ‹¨**: ν—μ©λμ§€ μ•μ€ ν”„λ΅μ„Έμ¤μ ν‚¤ μ…λ ¥ μ™„μ „ μ°¨λ‹¨

### INI νμΌ μ„¤μ •

`config.ini` νμΌ ν•μ‹:

```ini
[AllowedProcesses]
Process1=notepad++.exe
Process2=notepad.exe
Process3=code.exe
Process4=chrome.exe
```

- μµλ€ 100κ°μ ν”„λ΅μ„Έμ¤ λ“±λ΅ κ°€λ¥
- ν”„λ΅μ„Έμ¤ μ΄λ¦„μ€ λ€μ†λ¬Έμ κµ¬λ¶„ μ—†μ
- INI νμΌμ΄ μ—†μΌλ©΄ κΈ°λ³Έκ°’μΌλ΅ `notepad++.exe`λ§ ν—μ©

### Doxygen μ£Όμ„ μ¶”κ°€

λ¨λ“  ν•¨μμ™€ μ „μ—­ λ³€μμ— Doxygen μ¤νƒ€μΌμ μ£Όμ„μ„ μ¶”κ°€ν•μ—¬ μ½”λ“ λ¬Έμ„ν™”λ¥Ό κ°μ„ ν–μµλ‹λ‹¤.

## π“ κΈ°μ  μ¤νƒ

- **μ–Έμ–΄**: C99
- **ν”λ«νΌ**: Windows API
- **ν›„ν¬ νƒ€μ…**: `WH_KEYBOARD_LL` (μ €μμ¤€ ν‚¤λ³΄λ“ ν›„ν¬)
- **μ»΄νμΌλ¬**: GCC (MinGW-w64)
- **νƒ€κ²**: 32λΉ„νΈ (λ¨λ“  Windows λ²„μ „ νΈν™)

## π¤ κΈ°μ—¬ν•κΈ°

1. μ΄ μ €μ¥μ†λ¥Ό ν¬ν¬ν•©λ‹λ‹¤
2. μƒ κΈ°λ¥ λΈλμΉλ¥Ό μƒμ„±ν•©λ‹λ‹¤ (`git checkout -b feature/AmazingFeature`)
3. λ³€κ²½μ‚¬ν•­μ„ μ»¤λ°‹ν•©λ‹λ‹¤ (`git commit -m 'Add some AmazingFeature'`)
4. λΈλμΉμ— ν‘Έμ‹ν•©λ‹λ‹¤ (`git push origin feature/AmazingFeature`)
5. Pull Requestλ¥Ό μƒμ„±ν•©λ‹λ‹¤

## π“ λΌμ΄μ„ μ¤

μ΄ ν”„λ΅μ νΈλ” κµμ΅ λ° λ³΄μ• μ—°κµ¬ λ©μ μΌλ΅ μ μ‘λμ—μµλ‹λ‹¤.

**μ£Όμ:** μƒμ—…μ  μ‚¬μ©μ΄λ‚ μ•…μμ μΈ λ©μ μΌλ΅ μ‚¬μ©ν•μ§€ λ§μ„Έμ”.

## π“ λ¬Έμ

ν”„λ΅μ νΈμ— λ€ν• μ§λ¬Έμ΄λ‚ μ μ•μ‚¬ν•­μ΄ μμΌμ‹λ©΄ μ΄μλ¥Ό μƒμ„±ν•΄μ£Όμ„Έμ”.

---

## π“– μ¶”κ°€ μ •λ³΄

### λΉλ“ ν™•μΈ

```cmd
# λΉλ“ μ •λ³΄ ν™•μΈ
dumpbin /headers bin\keyboard_protector.exe | findstr machine
```

### μ‹¤ν–‰ μ‹ μ¶λ ¥ μμ‹

```
[μ„¤μ •] INI νμΌ λ΅λ“ μ‹λ„: C:\path\to\config.ini
[μ„¤μ •] ν—μ© ν”„λ΅μ„Έμ¤ μ¶”κ°€: notepad++.exe
[μ„¤μ •] ν—μ© ν”„λ΅μ„Έμ¤ μ¶”κ°€: notepad.exe
[μ„¤μ •] μ΄ 2κ°μ ν—μ© ν”„λ΅μ„Έμ¤κ°€ λ΅λ“λμ—μµλ‹λ‹¤.
[μ„±κ³µ] ν‚¤λ³΄λ“ λ³΄μ• ν΄μ΄ μ‹¤ν–‰λμ—μµλ‹λ‹¤. λ¨λ“  ν‚¤ μ…λ ¥μ΄ μ•”νΈν™”λμ–΄ μ¶λ ¥λ©λ‹λ‹¤.
[μ •λ³΄] κ΄€λ¦¬μ κ¶ν•μΌλ΅ μ‹¤ν–‰ μ¤‘μ…λ‹λ‹¤.
---------------------------------------------------------
Esc ν‚¤λ¥Ό λλ¬ μΆ…λ£ν•μ‹­μ‹μ¤.

[ν‚¤ κ°μ§€] μ›λ³Έ KeyCode: 65 | μ†”νΈ: 12345678 | μ•”νΈν™”λ KeyCode: 12345619
[λ³µνΈν™”] ν”„λ΅μ„Έμ¤: notepad++.exe | λ³µνΈν™”λ KeyCode: 65
[ν‚¤ κ°μ§€] μ›λ³Έ KeyCode: 66 | μ†”νΈ: 12345679 | μ•”νΈν™”λ KeyCode: 12345621
[μ°¨λ‹¨] ν”„λ΅μ„Έμ¤: chrome.exe | ν‚¤ μ…λ ¥μ΄ μ°¨λ‹¨λμ—μµλ‹λ‹¤.

[μ•λ¦Ό] Esc ν‚¤κ°€ λλ Έμµλ‹λ‹¤. ν›„ν¬λ¥Ό ν•΄μ ν•κ³  μΆ…λ£ν•©λ‹λ‹¤.

[μΆ…λ£] ν‚¤λ³΄λ“ λ³΄μ• ν΄μ΄ μ •μƒμ μΌλ΅ μΆ…λ£λμ—μµλ‹λ‹¤.
```

### μ§€μ›λλ” Windows λ²„μ „

| OS | μ§€μ› μ—¬λ¶€ |
|----|----------|
| Windows XP | β… (WOW64 μ—†μ) |
| Windows Vista | β… (WOW64 ν¬ν•¨) |
| Windows 7 | β… (WOW64 ν¬ν•¨) |
| Windows 8/10/11 | β… (WOW64 ν¬ν•¨) |

**μ°Έκ³ :** 32λΉ„νΈ λΉλ“λ” 64λΉ„νΈ Windowsμ—μ„ WOW64λ¥Ό ν†µν•΄ μλ™μΌλ΅ μ‹¤ν–‰λ©λ‹λ‹¤.
